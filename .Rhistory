# Create the donut chart with two rings
ggplot(combined_data) +
geom_bar(aes(x = ring, y = pct, fill = interaction(factor(Method), Gender)),
stat = "identity", width = 0.7) +
coord_polar("y", start = 0) +
theme_void() +
xlim(0.5, 2.5) +  # Creates the donut hole
labs(title = "Payment Method Usage: Men (Inner) vs Women (Outer)") +
scale_fill_manual(
name = "Payment Method & Gender",
values = c(
"0.Men" = "#8B4A6B", "1.Men" = "#5A7A5A", "2.Men" = "#6B8CAE", "3.Men" = "#B8860B",
"0.Women" = "#D4A5C4", "1.Women" = "#8FAF8F", "2.Women" = "#9BB5D4", "3.Women" = "#E6B84D"
),
labels = c("Digital Wallet (Men)", "Card (Men)", "Paypal (Men)", "Other (Men)",
"Digital Wallet (Women)", "Card (Women)", "Paypal (Women)", "Other (Women)")
)
library(ggplot2)
library(dplyr)
library(readr)
library(tidyverse)
library(corrplot)
CSD <- read.csv("Customer_Sales.csv")
View(CSD)
#View first few rows of data
head(CSD)
#Get summary statistic of data
summary(CSD)
str(CSD)
#remove rows with NA value
clean_CSD <- na.omit(CSD)
#Identify duplicate row
duplicate_rows <- duplicated(CSD)
#Rename columns
colnames(CSD) [c(1,4,5,6,7,8,9)] <- c("ID", "Revenue", "Purchases", "Date", "Value", "Method", "Time")
View (CSD)
sapply(CSD,class)
#convert data type of data
CSD_clean <- CSD %>%
mutate(Date = as.Date(Date, format = "%d.%m.%y"))
View(CSD_clean)
sapply(CSD_clean,class)
CSD_clean <- CSD_clean %>%
mutate(Age_Group = ifelse(Age < 28, "Young",ifelse(Age < 40, "Middle", "Old")))
view
CSD_male <- filter(CSD_clean, Gender == 0)  # filter out males
CSD_cleanedmale <- CSD_male %>%
count(Method) %>%
mutate (pct = n / sum(n) * 100) # calculate percentages
View(CSD_cleanedmale)
CSD_female <- filter(CSD_clean, Gender == 1) #filter out females
CSD_cleanedfemale <- CSD_male %>%
count(Method) %>%
mutate (pct = n / sum(n) * 100) # calculate percentages
View(CSD_cleanedfemale)
CSD_old <- filter(CSD_clean, Age_group == "Old")
CSD_cleanedold <- CSD_old %>%
count(Method) %>%
mutate (pct = n / sum(n) * 100) # calculate percentages
View(CSD_cleanedold)
CSD_old <- filter(CSD_clean, Age_group == "Middle")
CSD_cleanemiddle <- CSD_middle %>%
count(Method) %>%
mutate (pct = n / sum(n) * 100) # calculate percentages
View(CSD_cleanedmiddle)
CSD_old <- filter(CSD_clean, Age_group == "Young")
CSD_cleanedyoung <- CSD_young %>%
count(Method) %>%
mutate (pct = n / sum(n) * 100) # calculate percentages
View(CSD_cleanedyoung)
ggplot(CSD_cleanedmale) +
geom_bar(aes(x = "", y = pct, fill = factor(Method)), stat = "identity") +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Percentage of Payment Method Used by Men") +
scale_fill_manual(
name = "Payment Method",
values = c("0" = "#8B4A6B", "1" = "#5A7A5A", "2" = "#6B8CAE", "3" = "#B8860B"),
labels = c("0" = "Digital Wallet", "1" = "Card", "2" = "Paypal", "3" = "Other")
)
# chart for payment method of women
ggplot(CSD_cleanedfemale) +
geom_bar(aes(x = "", y = pct, fill = factor(Method)), stat = "identity") +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Percentage of Payment Method used by Women") +
scale_fill_manual(
name = "Payment Method",
values = c("0" = "#8B4A6B", "1" = "#5A7A5A", "2" = "#6B8CAE", "3" = "#B8860B"),
labels = c("0" = "Digital Wallet", "1" = "Card", "2" = "Paypal", "3" = "Other")
)
ggplot (CSD_cleanedmale)+
geom_col(aes ( x = Method, y = pct, fill = factor (Method)))+
theme(axis.text.x = element_text(size = 5 , angle = 45 , vjust = 0.5))+
labs ( title = "Percentage of Pay Method Used by Men",
x = "Payment Method",
y = " pct" ) +
scale_fill_manual(
name= "Payment Method",
values = c("0" = "
#8B4A6B", "1" = "
#5A7A5A", "2"= "
#6B8CAE", "3"="
#B8860B"),
labels = c("0" = "Digital Wallet", "1" = "Card", "2" ="Paypal","3"="Other")
) #ai fixed + on wrong line
# Combine the data and add a ring position
combined_data <- bind_rows(
CSD_cleanedmale %>% mutate(Gender = "Men", ring = 1),
CSD_cleanedfemale %>% mutate(Gender = "Women", ring = 2)
)
# Create the donut chart with two rings
ggplot(combined_data) +
geom_bar(aes(x = ring, y = pct, fill = interaction(factor(Method), Gender)),
stat = "identity", width = 0.7) +
coord_polar("y", start = 0) +
theme_void() +
xlim(0.5, 2.5) +  # Creates the donut hole
labs(title = "Payment Method Usage: Men (Inner) vs Women (Outer)") +
scale_fill_manual(
name = "Payment Method & Gender",
values = c(
"0.Men" = "#8B4A6B", "1.Men" = "#5A7A5A", "2.Men" = "#6B8CAE", "3.Men" = "#B8860B",
"0.Women" = "#D4A5C4", "1.Women" = "#8FAF8F", "2.Women" = "#9BB5D4", "3.Women" = "#E6B84D"
),
labels = c("Digital Wallet (Men)", "Card (Men)", "Paypal (Men)", "Other (Men)",
"Digital Wallet (Women)", "Card (Women)", "Paypal (Women)", "Other (Women)")
)
# Create the donut chart with two rings
ggplot(combined_data) +
geom_bar(aes(x = ring, y = pct, fill = interaction(factor(Method), Gender)),
stat = "identity", width = 0.7) +
coord_polar("y", start = 0) +
theme_void() +
xlim(0.5, 2.5) +  # Creates the donut hole
labs(title = "Payment Method Usage: Men (Inner) vs Women (Outer)") +
scale_fill_manual(
name = "Payment Method & Gender",
values = c(
"0.Men" = "#8B4A6B", "1.Men" = "#5A7A5A", "2.Men" = "#6B8CAE", "3.Men" = "#B8860B",
"0.Women" = "#D4A5C4", "1.Women" = "#8FAF8F", "2.Women" = "#9BB5D4", "3.Women" = "#E6B84D"
),
labels = c("Digital Wallet (Men)", "Card (Men)", "Paypal (Men)", "Other (Men)",
"Digital Wallet (Women)", "Card (Women)", "Paypal (Women)", "Other (Women)")
)
# Create the donut chart with two rings
ggplot(combined_data) +
geom_bar(aes(x = ring, y = pct, fill = interaction(factor(Method), Gender)),
stat = "identity", width = 0.7) +
coord_polar("y", start = 0) +
theme_void() +
xlim(0.5, 2.5) +  # Creates the donut hole
labs(title = "Payment Method Usage: Men (Inner) vs Women (Outer)") +
scale_fill_manual(
name = "Payment Method & Gender",
values = c(
"0.Men" = "#8B4A6B", "1.Men" = "#5A7A5A", "2.Men" = "#6B8CAE", "3.Men" = "#B8860B",
"0.Women" = "#D4A5C4", "1.Women" = "#8FAF8F", "2.Women" = "#9BB5D4", "3.Women" = "#E6B84D"
),
labels = c("Digital Wallet (Men)", "Card (Men)", "Paypal (Men)", "Other (Men)",
"Digital Wallet (Women)", "Card (Women)", "Paypal (Women)", "Other (Women)")
)
# chart old people payment method
ggplot (CSD_cleanedold)+
geom_col(aes ( x = Method, y = pct, fill = factor (Method)))+
theme(axis.text.x = element_text(size = 5 , angle = 45 , vjust = 0.5))+
labs ( title = "Percentage of Payment Method used by people over 40",
x = "Payment Method",
y = " pct" ) +
scale_fill_manual(
name= "Payment Method",
values = c("0" = "
#8B4A6B", "1" = "
#5A7A5A", "2"= "
#6B8CAE", "3"="
#B8860B"),
labels = c("0" = "Digital Wallet", "1" = "Card", "2" ="Paypal","3"="Other")
) #ai fixed + on wrong line
library(ggplot2)
library(dplyr)
library(readr)
library(tidyverse)
library(corrplot)
CSD <- read.csv("Customer_Sales.csv")
View(CSD)
japan_admin <- japan_admin  %>%  select(ID=ADM1_EN) %>% # forgot to include the datframe here, AI assistance
mutate(ID = str_trim(str_replace_all(ID, c('Hyōgo'='Hyogo','Kōchi'='Kochi','Ōita'='Oita','Gunma'='Gumma'))))
library(ggplot2)
library(dplyr)
library(readr)
library(tidyverse)
library(corrplot)
CSD <- read.csv("Customer_Sales.csv")
View(CSD)
#Get summary statistic of data
summary(CSD)
str(CSD)
#remove rows with NA value
clean_CSD <- na.omit(CSD)
#Identify duplicate row
duplicate_rows <- duplicated(CSD)
sapply(CSD,class)
#convert data type of data
CSD_clean <- CSD %>%
mutate(Date = as.Date(Date, format = "%d.%m.%y"))
View(CSD_clean)
sapply(CSD_clean,class)
CSD_clean <- CSD_clean %>%
mutate(Age_Group = ifelse(Age < 28, "Young",ifelse(Age < 40, "Middle", "Old")))
view
CSD_male <- filter(CSD_clean, Gender == 0)  # filter out males
CSD_cleanedmale <- CSD_male %>%
count(Method) %>%
mutate (pct = n / sum(n) * 100) # calculate percentages
CSD_female <- filter(CSD_clean, Gender == 1) #filter out females
CSD_cleanedfemale <- CSD_male %>%
count(Method) %>%
mutate (pct = n / sum(n) * 100) # calculate percentages
CSD_old <- filter(CSD_clean, Age_group == "Old")
CSD_cleanedold <- CSD_old %>%
count(Method) %>%
mutate (pct = n / sum(n) * 100) # calculate percentages
CSD_old <- filter(CSD_clean, Age_group == "Middle")
CSD_cleanemiddle <- CSD_middle %>%
count(Method) %>%
mutate (pct = n / sum(n) * 100) # calculate percentages
CSD_old <- filter(CSD_clean, Age_group == "Young")
CSD_cleanedyoung <- CSD_young %>%
count(Method) %>%
mutate (pct = n / sum(n) * 100) # calculate percentages
ggplot(CSD_cleanedmale) +
geom_bar(aes(x = "", y = pct, fill = factor(Method)), stat = "identity") +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Percentage of Payment Method Used by Men") +
scale_fill_manual(
name = "Payment Method",
values = c("0" = "#8B4A6B", "1" = "#5A7A5A", "2" = "#6B8CAE", "3" = "#B8860B"),
labels = c("0" = "Digital Wallet", "1" = "Card", "2" = "Paypal", "3" = "Other")
)
# chart for payment method of women
ggplot(CSD_cleanedfemale) +
geom_bar(aes(x = "", y = pct, fill = factor(Method)), stat = "identity") +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Percentage of Payment Method used by Women") +
scale_fill_manual(
name = "Payment Method",
values = c("0" = "#8B4A6B", "1" = "#5A7A5A", "2" = "#6B8CAE", "3" = "#B8860B"),
labels = c("0" = "Digital Wallet", "1" = "Card", "2" = "Paypal", "3" = "Other")
)
ggplot (CSD_cleanedmale)+
geom_col(aes ( x = Method, y = pct, fill = factor (Method)))+
theme(axis.text.x = element_text(size = 5 , angle = 45 , vjust = 0.5))+
labs ( title = "Percentage of Pay Method Used by Men",
x = "Payment Method",
y = " pct" ) +
scale_fill_manual(
name= "Payment Method",
values = c("0" = "
#8B4A6B", "1" = "
#5A7A5A", "2"= "
#6B8CAE", "3"="
#B8860B"),
labels = c("0" = "Digital Wallet", "1" = "Card", "2" ="Paypal","3"="Other")
) #ai fixed + on wrong line
ggplot (CSD_cleanedmale)+
geom_col(aes ( x = Method, y = pct, fill = factor (Method)))+
theme(axis.text.x = element_text(size = 5 , angle = 45 , vjust = 0.5))+
labs ( title = "Percentage of Pay Method Used by Men",
x = "Payment Method",
y = " pct" ) +
scale_fill_manual(
name= "Payment Method",
values = c("0" = "
#8B4A6B", "1" = "
#5A7A5A", "2"= "
#6B8CAE", "3"="
#B8860B"),
labels = c("0" = "Digital Wallet", "1" = "Card", "2" ="Paypal","3"="Other")
) #ai fixed + on wrong line
ggplot (CSD_cleanedmale)+
geom_col(aes ( x = Method, y = pct, fill = factor (Method)))+
theme(axis.text.x = element_text(size = 5 , angle = 45 , vjust = 0.5))+
labs ( title = "Percentage of Pay Method Used by Men",
x = "Payment Method",
y = " pct" ) +
scale_fill_manual(
name= "Payment Method",
values = c("0" = "#8B4A6B", "1" = "#5A7A5A", "2"= "#6B8CAE", "3"="#B8860B"),
labels = c("0" = "Digital Wallet", "1" = "Card", "2" ="Paypal","3"="Other")
) #ai fixed + on wrong line
ggplot(CSD_cleanedmale) +
geom_bar(aes(x = "", y = pct, fill = factor(Method)), stat = "identity") +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Percentage of Payment Method Used by Men") +
scale_fill_manual(
name = "Payment Method",
values = c("0" = "#8B4A6B", "1" = "#5A7A5A", "2" = "#6B8CAE", "3" = "#B8860B"),
labels = c("0" = "Digital Wallet", "1" = "Card", "2" = "Paypal", "3" = "Other")
)
# chart for payment method of women
ggplot(CSD_cleanedfemale) +
geom_bar(aes(x = "", y = pct, fill = factor(Method)), stat = "identity") +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Percentage of Payment Method used by Women") +
scale_fill_manual(
name = "Payment Method",
values = c("0" = "#8B4A6B", "1" = "#5A7A5A", "2" = "#6B8CAE", "3" = "#B8860B"),
labels = c("0" = "Digital Wallet", "1" = "Card", "2" = "Paypal", "3" = "Other")
)
ggplot(CSD_cleanedmale) +
geom_bar(aes(x = "", y = pct, fill = factor(Method)), stat = "identity") +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Percentage of Payment Method Used by Men") +
scale_fill_manual(
name = "Payment Method",
values = c("0" = "#8B4A6B", "1" = "#5A7A5A", "2" = "#6B8CAE", "3" = "#B8860B"),
labels = c("0" = "Digital Wallet", "1" = "Card", "2" = "Paypal", "3" = "Other")
)
# chart for payment method of women
ggplot(CSD_cleanedfemale) +
geom_bar(aes(x = "", y = pct, fill = factor(Method)), stat = "identity") +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Percentage of Payment Method used by Women") +
scale_fill_manual(
name = "Payment Method",
values = c("0" = "#8B4A6B", "1" = "#5A7A5A", "2" = "#6B8CAE", "3" = "#B8860B"),
labels = c("0" = "Digital Wallet", "1" = "Card", "2" = "Paypal", "3" = "Other")
)
CSD_female <- filter(CSD_clean, Gender == 1) #filter out females
CSD_cleanedfemale <- CSD_male %>%
count(Method) %>%
mutate (pct = n / sum(n) * 100) # calculate percentages
ggplot (CSD_cleanedmale)+
geom_col(aes ( x = Method, y = pct, fill = factor (Method)))+
theme(axis.text.x = element_text(size = 5 , angle = 45 , vjust = 0.5))+
labs ( title = "Percentage of Pay Method Used by Men",
x = "Payment Method",
y = " pct" ) +
scale_fill_manual(
name= "Payment Method",
values = c("0" = "#8B4A6B", "1" = "#5A7A5A", "2"= "#6B8CAE", "3"="#B8860B"),
labels = c("0" = "Digital Wallet", "1" = "Card", "2" ="Paypal","3"="Other")
) #ai fixed + on wrong line
ggplot (CSD_cleanedmale)+
geom_col(aes ( x = Method, y = pct, fill = factor (Method)))+
theme(axis.text.x = element_text(size = 5 , angle = 45 , vjust = 0.5))+
labs ( title = "Percentage of Pay Method Used by Men",
x = "Payment Method",
y = " pct" ) +
scale_fill_manual(
name= "Payment Method",
values = c("0" = "#8B4A6B", "1" = "#5A7A5A", "2"= "#6B8CAE", "3"="#B8860B"),
labels = c("0" = "Digital Wallet", "1" = "Card", "2" ="Paypal","3"="Other")
) #ai fixed + on wrong line
# chart for payment method of women
ggplot(CSD_cleanedfemale) +
geom_bar(aes(x = "", y = pct, fill = factor(Method)), stat = "identity") +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Percentage of Payment Method used by Women") +
scale_fill_manual(
name = "Payment Method",
values = c("0" = "#8B4A6B", "1" = "#5A7A5A", "2" = "#6B8CAE", "3" = "#B8860B"),
labels = c("0" = "Digital Wallet", "1" = "Card", "2" = "Paypal", "3" = "Other")
)
ggplot (CSD_cleanedmale)+
geom_col(aes ( x = Method, y = pct, fill = factor (Method)))+
theme(axis.text.x = element_text(size = 5 , angle = 45 , vjust = 0.5))+
labs ( title = "Percentage of Pay Method Used by Men",
x = "Payment Method",
y = " pct" ) +
scale_fill_manual(
name= "Payment Method",
values = c("0" = "#8B4A6B", "1" = "#5A7A5A", "2"= "#6B8CAE", "3"="#B8860B"),
labels = c("0" = "Digital Wallet", "1" = "Card", "2" ="Paypal","3"="Other")
) #ai fixed + on wrong line
# chart for payment method of women
ggplot(CSD_cleanedfemale) +
geom_bar(aes(x = "", y = pct, fill = factor(Method)), stat = "identity") +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Percentage of Payment Method used by Women") +
scale_fill_manual( name = "Payment Method",
values = c("0" = "#8B4A6B", "1" = "#5A7A5A", "2" = "#6B8CAE", "3" = "#B8860B"),
labels = c("0" = "Digital Wallet", "1" = "Card", "2" = "Paypal", "3" = "Other")
)
ggplot (CSD_cleanedmale)+
geom_col(aes ( x = Method, y = pct, fill = factor (Method)))+
theme(axis.text.x = element_text(size = 5 , angle = 45 , vjust = 0.5))+
labs ( title = "Percentage of Pay Method Used by Men",
x = "Payment Method",
y = " pct" ) +
scale_fill_manual(
name= "Payment Method",
values = c("0" = "#8B4A6B", "1" = "#5A7A5A", "2"= "#6B8CAE", "3"="#B8860B"),
labels = c("0" = "Digital Wallet", "1" = "Card", "2" ="Paypal","3"="Other")
) #ai fixed + on wrong line
ggplot (CSD_cleanedmale)+
geom_col(aes ( x = Method, y = pct, fill = factor (Method)))+
theme(axis.text.x = element_text(size = 5 , angle = 45 , vjust = 0.5))+
labs ( title = "Percentage of Pay Method Used by Men",
x = "Payment Method",
y = " pct" ) +
scale_fill_manual(
name= "Payment Method",
values = c("0" = "#8B4A6B", "1" = "#5A7A5A", "2"= "#6B8CAE", "3"="#B8860B"),
labels = c("0" = "Digital Wallet", "1" = "Card", "2" ="Paypal","3"="Other")
) #ai fixed + on wrong line
ggplot(CSD_cleanedmale) +
geom_bar(aes(x = "", y = pct, fill = factor(Method)), stat = "identity") +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Percentage of Payment Method Used by Men") +
scale_fill_manual(
name = "Payment Method",
values = c("0" = "#8B4A6B", "1" = "#5A7A5A", "2" = "#6B8CAE", "3" = "#B8860B"),
labels = c("0" = "Digital Wallet", "1" = "Card", "2" = "Paypal", "3" = "Other")
)
# chart for payment method of women
ggplot(CSD_cleanedfemale) +
geom_bar(aes(x = "", y = pct, fill = factor(Method)), stat = "identity") +
coord_polar("y", start = 0) +
theme_void() +
labs(title = "Percentage of Payment Method used by Women") +
scale_fill_manual( name = "Payment Method",
values = c("0" = "#8B4A6B", "1" = "#5A7A5A", "2" = "#6B8CAE", "3" = "#B8860B"),
labels = c("0" = "Digital Wallet", "1" = "Card", "2" = "Paypal", "3" = "Other")
)
